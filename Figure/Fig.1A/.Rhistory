for (i in 1: length(unique(mynet$SOURCE)) ){
E(net)[map(unique(mynet$SOURCE),function(x) {
get.edge.ids(net,vp = c(unique(mynet$SOURCE)[i],x))
})%>% unlist()]$color <- allcolour[i]
}
plot(net, edge.arrow.size=.1,
edge.curved=0.2, # 只是调了这个参数
vertex.color=allcolour,
vertex.frame.color="#555555",
vertex.label.color="black",
layout = coords,
vertex.label.cex=.7)
setwd('/Users/zhoujiayi/Desktop/communication/cut7d/siCTRL')
mynet <- read.delim("../siWTAP/count_network.txt", check.names = FALSE)
net<- graph_from_data_frame(mynet)
plot(net)
allcolour=c("#DC143C","#0000FF","#20B2AA","#FFA500","#9370DB",
"#98FB98","#F08080","#1E90FF","#7CFC00","#FFFF00",
"#808000","#FF00FF","#FA8072","#7B68EE","#9400D3",
"#800080","#A0522D","#D2B48C","#D2691E","#87CEEB",
"#40E0D0","#5F9EA0","#FF1493",
"#FFE4B5","#8A2BE2","#228B22","#E9967A","#4682B4",
"#32CD32","#F0E68C","#FFFFE0","#EE82EE","#FF6347",
"#6A5ACD","#9932CC","#8B008B","#8B4513","#DEB887")
karate_groups <- cluster_optimal(net)
coords <- layout_in_circle(net, order =
order(membership(karate_groups)))  # 设置网络布局
E(net)$width  <- E(net)$count/4+0.0000000001  # 边点权重（粗细）
for (i in 1: length(unique(mynet$SOURCE)) ){
E(net)[map(unique(mynet$SOURCE),function(x) {
get.edge.ids(net,vp = c(unique(mynet$SOURCE)[i],x))
})%>% unlist()]$color <- allcolour[i]
}
plot(net, edge.arrow.size=.1,
edge.curved=0.2, # 只是调了这个参数
vertex.color=allcolour,
vertex.frame.color="#555555",
vertex.label.color="black",
layout = coords,
vertex.label.cex=.7)
mynet <- read.delim("count_network.txt", check.names = FALSE)
net<- graph_from_data_frame(mynet)
plot(net)
allcolour=c("#DC143C","#0000FF","#20B2AA","#FFA500","#9370DB",
"#98FB98","#F08080","#1E90FF","#7CFC00","#FFFF00",
"#808000","#FF00FF","#FA8072","#7B68EE","#9400D3",
"#800080","#A0522D","#D2B48C","#D2691E","#87CEEB",
"#40E0D0","#5F9EA0","#FF1493",
"#FFE4B5","#8A2BE2","#228B22","#E9967A","#4682B4",
"#32CD32","#F0E68C","#FFFFE0","#EE82EE","#FF6347",
"#6A5ACD","#9932CC","#8B008B","#8B4513","#DEB887")
karate_groups <- cluster_optimal(net)
coords <- layout_in_circle(net, order =
order(membership(karate_groups)))  # 设置网络布局
E(net)$width  <- E(net)$count/4+0.0000000001  # 边点权重（粗细）
for (i in 1: length(unique(mynet$SOURCE)) ){
E(net)[map(unique(mynet$SOURCE),function(x) {
get.edge.ids(net,vp = c(unique(mynet$SOURCE)[i],x))
})%>% unlist()]$color <- allcolour[i]
}
plot(net, edge.arrow.size=.1,
edge.curved=0.2, # 只是调了这个参数
vertex.color=allcolour,
vertex.frame.color="#555555",
vertex.label.color="black",
layout = coords,
vertex.label.cex=.7)
library(pheatmap)
setwd('/Users/zhoujiayi/Desktop/singlecell/sort1')
data=read.table("cor.txt",header=T,row.names = 1,sep=" ")
data=t(data)
matrix=cor(data)
write.table(ma
write.table(matrix,"coefficient_matrix.txt",sep="\t")
setwd('/Users/zhoujiayi/Desktop/topgo')
data <- read.table("epidermal_up.txt",sep="\t",quote="",head=T,stringsAsFactors=F);
data_pvalue <- (-log10(as.numeric(data[,2])))
names(data_pvalue)<-data[,1];
all_pv<-sort(unique(data_pvalue));
col_data_pvalue <- NULL;
for(i in 1:length(data_pvalue))
{
col_data_pvalue<-c(col_data_pvalue,which(all_pv==data_pvalue[i]));
}
colors <- colorRampPalette(c("#FFDDE0", "#FE8284"))(8)
par(mar=c(10,18,6,2),lwd=3);
barplot(rev(data_pvalue),horiz=T,las=1,cex.names=1,xlim=c(0,6),ylim=c(0,16),space=0.5,col=colors,xlab="-log10(pvalue)",xaxt="n",border = NA)
axis(1,at=c(0,1,2,3,4,5),lwd=3,tcl=-1)
data <- read.table("neoblast_up.txt",sep="\t",quote="",head=T,stringsAsFactors=F);
data_pvalue <- (-log10(as.numeric(data[,2])))
names(data_pvalue)<-data[,1];
all_pv<-sort(unique(data_pvalue));
col_data_pvalue <- NULL;
for(i in 1:length(data_pvalue))
{
col_data_pvalue<-c(col_data_pvalue,which(all_pv==data_pvalue[i]));
}
colors <- colorRampPalette(c("#FFDDE0", "#FE8284"))(8)
par(mar=c(10,18,6,2),lwd=3);
barplot(rev(data_pvalue),horiz=T,las=1,cex.names=1,xlim=c(0,6),ylim=c(0,16),space=0.5,col=colors,xlab="-log10(pvalue)",xaxt="n",border = NA)
axis(1,at=c(0,1,2,3,4,5),lwd=3,tcl=-1)
a<-read.table("epidermal_down",head=T,sep="\t",stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows =F ,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border = F,color=colorRampPalette(c("#FF686A","white","#89D0F3"))(50))
a<-read.table("epidermal_down.txt",head=T,sep="\t",stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows =F ,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border = F,color=colorRampPalette(c("#FF686A","white","#89D0F3"))(50))
a<-read.table("neoblast_down.txt",head=T,sep="\t",stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows =F ,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border = F,color=colorRampPalette(c("#FF686A","white","#89D0F3"))(50))
a<-read.table("neuronal_down.txt",head=T,sep="\t",stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows =F ,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border = F,color=colorRampPalette(c("#FF686A","white","#89D0F3"))(50))
data <- read.table("neoblast_up.txt",sep="\t",quote="",head=T,stringsAsFactors=F);
data_pvalue <- (-log10(as.numeric(data[,2])))
names(data_pvalue)<-data[,1];
all_pv<-sort(unique(data_pvalue));
col_data_pvalue <- NULL;
for(i in 1:length(data_pvalue))
{
col_data_pvalue<-c(col_data_pvalue,which(all_pv==data_pvalue[i]));
}
colors <- colorRampPalette(c("#FFDDE0", "#FF101D"))(8)
par(mar=c(10,18,6,2),lwd=3);
barplot(rev(data_pvalue),horiz=T,las=1,cex.names=1,xlim=c(0,6),ylim=c(0,16),space=0.5,col=colors,xlab="-log10(pvalue)",xaxt="n",border = NA)
axis(1,at=c(0,1,2,3,4,5),lwd=3,tcl=-1)
data <- read.table("neoblast_up.txt",sep="\t",quote="",head=T,stringsAsFactors=F);
data_pvalue <- (-log10(as.numeric(data[,2])))
names(data_pvalue)<-data[,1];
all_pv<-sort(unique(data_pvalue));
col_data_pvalue <- NULL;
for(i in 1:length(data_pvalue))
{
col_data_pvalue<-c(col_data_pvalue,which(all_pv==data_pvalue[i]));
}
par(mar=c(10,18,6,2),lwd=3);
barplot(rev(data_pvalue),horiz=T,las=1,cex.names=1,xlim=c(0,6),ylim=c(0,16),space=0.5,col="#FF101D",xlab="-log10(pvalue)",xaxt="n",border = NA)
axis(1,at=c(0,1,2,3,4,5),lwd=3,tcl=-1)
setwd('/Users/zhoujiayi/Desktop/singlecell/cluster_go')
data <- read.table("cluster_1.txt",sep="\t",quote="",head=T,stringsAsFactors=F);
data_pvalue <- (-log10(as.numeric(data[,2])))
names(data_pvalue)<-data[,1];
all_pv<-sort(unique(data_pvalue));
col_data_pvalue <- NULL;
for(i in 1:length(data_pvalue))
{
col_data_pvalue<-c(col_data_pvalue,which(all_pv==data_pvalue[i]));
}
par(mar=c(10,18,6,2),lwd=3);
barplot(rev(data_pvalue),horiz=T,las=1,cex.names=1,xlim=c(0,6),ylim=c(0,16),space=0.5,col="#FF101D",xlab="-log10(pvalue)",xaxt="n",border = NA)
axis(1,at=c(0,1,2,3,4,5),lwd=3,tcl=-1)
data <- read.table("cluster_1.txt",sep="\t",quote="",head=T,stringsAsFactors=F);
data_pvalue <- (-log10(as.numeric(data[,2])))
names(data_pvalue)<-data[,1];
all_pv<-sort(unique(data_pvalue));
col_data_pvalue <- NULL;
for(i in 1:length(data_pvalue))
{
col_data_pvalue<-c(col_data_pvalue,which(all_pv==data_pvalue[i]));
}
par(mar=c(10,18,6,2),lwd=3);
barplot(rev(data_pvalue),horiz=T,las=1,cex.names=1,xlim=c(0,12),ylim=c(0,16),space=0.5,col="#FF101D",xlab="-log10(pvalue)",xaxt="n",border = NA)
axis(1,at=c(0,4,8,12),lwd=3,tcl=-1)
data <- read.table("cluster_1.txt",sep="\t",quote="",head=F,stringsAsFactors=F);
data_pvalue <- (-log10(as.numeric(data[,2])))
names(data_pvalue)<-data[,1];
all_pv<-sort(unique(data_pvalue));
col_data_pvalue <- NULL;
for(i in 1:length(data_pvalue))
{
col_data_pvalue<-c(col_data_pvalue,which(all_pv==data_pvalue[i]));
}
par(mar=c(10,18,6,2),lwd=3);
barplot(rev(data_pvalue),horiz=T,las=1,cex.names=1,xlim=c(0,12),ylim=c(0,16),space=0.5,col="#FF101D",xlab="-log10(pvalue)",xaxt="n",border = NA)
axis(1,at=c(0,4,8,12),lwd=3,tcl=-1)
data <- read.table("cluster_2.txt",sep="\t",quote="",head=F,stringsAsFactors=F);
data_pvalue <- (-log10(as.numeric(data[,2])))
names(data_pvalue)<-data[,1];
all_pv<-sort(unique(data_pvalue));
col_data_pvalue <- NULL;
for(i in 1:length(data_pvalue))
{
col_data_pvalue<-c(col_data_pvalue,which(all_pv==data_pvalue[i]));
}
par(mar=c(10,18,6,2),lwd=3);
barplot(rev(data_pvalue),horiz=T,las=1,cex.names=1,xlim=c(0,10),ylim=c(0,16),space=0.5,col="#FF101D",xlab="-log10(pvalue)",xaxt="n",border = NA)
axis(1,at=c(0,5,10),lwd=3,tcl=-1)
data <- read.table("cluster_4.txt",sep="\t",quote="",head=F,stringsAsFactors=F);
data_pvalue <- (-log10(as.numeric(data[,2])))
names(data_pvalue)<-data[,1];
all_pv<-sort(unique(data_pvalue));
col_data_pvalue <- NULL;
for(i in 1:length(data_pvalue))
{
col_data_pvalue<-c(col_data_pvalue,which(all_pv==data_pvalue[i]));
}
par(mar=c(10,18,6,2),lwd=3);
barplot(rev(data_pvalue),horiz=T,las=1,cex.names=1,xlim=c(0,8),ylim=c(0,16),space=0.5,col="#FF101D",xlab="-log10(pvalue)",xaxt="n",border = NA)
axis(1,at=c(0,4,8),lwd=3,tcl=-1)
library(GenomicRanges)
library(GenomicFeatures)
install.packages('library(GenomicFeatures)')
install.packages('GenomicFeatures')
install.packages('annotatr')
BiocManager::install("GenomicFeatures")
BiocManager::install("annotatr")
library(GenomicRanges)
library(GenomicFeatures)
library(annotatr)
setwd('/Users/zhoujiayi/Desktop/gtf/')
makeTxDbFromGFF
txdb <- annotatr::makeTxDbFromGFF("Danio_rerio.Zv9.79.gtf", format="gtf")
txdb <- annotatr::makeTxDbFromGFF("Danio_rerio.Zv9.79.gtf", format="gtf")
txdb <- annotatr::makeTxDbFromGFF(gff_file, format="gtf")
txdb <- makeTxDbFromGFF("Danio_rerio.Zv9.79.gtf", format="gtf")
GRanges(txdb)
lent<-transcriptLengths(txdb, with.cds_len=TRUE,with.utr5_len=TRUE, with.utr3_len=TRUE)
head(lent)
?transcriptLengths
?transcripts
?transcriptLengths
head(lent,20)
??GenomicFeatures
?genomicLengths
?genomeLengths
?GenomicFeatures
??GenomicFeatures
lent<-transcript(txdb, with.cds_len=TRUE,with.utr5_len=TRUE, with.utr3_len=TRUE)
lent<-transcripts(txdb, with.cds_len=TRUE,with.utr5_len=TRUE, with.utr3_len=TRUE)
sum(len(utr5_len))
sum(lent$utr5_len)
sum(lent$utr3_len)
sum(lent$cds_len)
？exonsBy
?exonsBy
le<-fiveUTRsByTranscript(txdb,use.names=TRUE)
head(le)
le<-fiveUTRsByTranscript(txdb)
head(le)
setwd('/Users/zhoujiayi/Desktop/m6A/figure-code-2-1/1C')
require(graphics)
require(grDevices)
library(gplots)
library(pheatmap)
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(60,"blue","white","red"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(100,"#008CC1","#FAF7F6","#CF0C31"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(100,"#008CC1","#FAF7F6","#CF0C31"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
getwd()
a<-read.table("expression2.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(100,"#008CC1","#FAF7F6","#CF0C31"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
a<-read.table("expression2.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(100,"#008CC1","#FAF7F6","#CF0C31"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
setwd('require(graphics)
require(grDevices)
library(gplots)
library(pheatmap)')
require(graphics)
require(grDevices)
library(gplots)
library(pheatmap)
/Users/zhoujiayi/Desktop/m6A/figure-code-2-1/1C
setwd('/Users/zhoujiayi/Desktop/m6A/figure-code-2-1/1C')
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(60,"blue","white","red"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
pheatmap(a,cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(60,"blue","white","red"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
pheatmap(a,cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(60,"blue","white","red"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
bk <- c(seq(-2,-0.1,by=0.01),seq(0,2,by=0.01))
pheatmap(a,
scale = "row",
color = c(colorRampPalette(colors = c("blue","white"))(length(bk)/2),colorRampPalette(colors = c("white","red"))(length(bk)/2)),
legend_breaks=seq(-8,8,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("blue","white"))(length(bk)/2),colorRampPalette(colors = c("white","red"))(length(bk)/2)),
legend_breaks=seq(-8,8,2),
breaks=bk)
bk <- c(seq(-10,-0.1,by=0.01),seq(0,10,by=0.01))
# 做热图：
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("blue","white"))(length(bk)/2),colorRampPalette(colors = c("white","red"))(length(bk)/2)),
legend_breaks=seq(-8,8,2),
breaks=bk)
bk <- c(seq(-5,-0.1,by=0.01),seq(0,5,by=0.01))
# 做热图：
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("blue","white"))(length(bk)/2),colorRampPalette(colors = c("white","red"))(length(bk)/2)),
legend_breaks=seq(-5,5,2),
breaks=bk)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(60,"#FF69B4","#CD6090"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(60,"#FF69B4","#8B3A62"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(60,"#FF6A6A","#FF6A6A"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("blue","white"))(length(bk)/2),colorRampPalette(colors = c("white","red"))(length(bk)/2)),
legend_breaks=seq(-5,5,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("blue","white"))(length(bk)/2),colorRampPalette(colors = c("white","red"))(length(bk)/2)),
legend_breaks=seq(-5,5,2),
breaks=bk)
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("blue","white"))(length(bk)/2),colorRampPalette(colors = c("white","red"))(length(bk)/2)),
legend_breaks=seq(-5,5,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#87CEFF","#FF0000"))(length(bk)/2),colorRampPalette(colors = c("white","red"))(length(bk)/2)),
legend_breaks=seq(-5,5,2),
breaks=bk)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(60,"#87CEFF","#FF0000"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(100,"#87CEFF","#FF0000"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#87CEFF","#FF0000"))(length(bk)/2)),
legend_breaks=seq(-5,5,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#87CEFF","#FF0000"))(length(bk))),
legend_breaks=seq(-5,5,2),
breaks=bk)
bk <- c(seq(-3,-0.1,by=0.01),seq(0,3,by=0.01))
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#87CEFF","#FF0000"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#FF0000"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#8B1A1A"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#CD2626"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#EE2C2C"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#104E8B","#EE2C2C"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#CD2626"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#1C86EE","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#FF3030","#8B1A1A"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#1E90FF","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#1E90FF","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#1E90FF","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "none",
color = c(colorRampPalette(colors = c("#1E90FF","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "none",
color = c(colorRampPalette(colors = c("#1E90FF","#FF3030"))(length(bk))),
#legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(100,"#87CEFF","#FF0000"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
pheatmap(a,scale="none",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(100,"#87CEFF","#FF0000"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
pheatmap(a,scale="row",cluster_rows = F,cluster_cols = F,show_colnames=T,show_rownames=T,legend=T,border_color="grey",color=colorpanel(100,"#87CEFF","#FF0000"),fontsize = 20,cellwidth = 60, cellheight = 60,gaps_row=c(1:2),cuttree_cols=4, gaps_col=c(1:4),cuttree_rows=2);
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "none",
color = c(colorRampPalette(colors = c("#1E90FF","#FF3030"))(length(bk))),
#legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#1E90FF","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
bk <- c(seq(-5,-0.1,by=0.01),seq(0,5,by=0.01))
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#1E90FF","#FF3030"))(length(bk))),
legend_breaks=seq(-5,5,2),
breaks=bk)
bk <- c(seq(-3,-0.1,by=0.01),seq(0,3,by=0.01))
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#1E90FF","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#1E90FF","#8B1A1A","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#FF3030","##EE2C2C","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#FF3030","#EE2C2C","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#FF3030","#8B1A1A","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#8B1A1A","#FF3030"))(length(bk))),
legend_breaks=seq(-3,3,2),
breaks=bk)
bk <- c(seq(-4,-0.1,by=0.01),seq(0,4,by=0.01))
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#8B1A1A","#FF3030"))(length(bk))),
legend_breaks=seq(-4,4,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#FF3030"))(length(bk))),
legend_breaks=seq(-4,4,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#916B85","#FF3030"))(length(bk))),
legend_breaks=seq(-4,4,2),
breaks=bk)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#B15A6E","#FF3030"))(length(bk))),
legend_breaks=seq(-4,4,2),
breaks=bk)
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#B15A6E","#FF3030"))(length(bk))),
legend_breaks=seq(-4,4,2),
breaks=bk)
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#B15A6E","#FF3030"))(length(bk))),
legend_breaks=seq(-4,4,2),
breaks=bk)
a<-read.table("expression1.txt",head=T,stringsAsFactors = F,row.names=1)
pheatmap(a,cluster_rows = F,cluster_cols = F,
scale = "row",
color = c(colorRampPalette(colors = c("#00BFFF","#B15A6E","#FF3030"))(length(bk))),
legend_breaks=seq(-4,4,2),
breaks=bk)
setwd('/Users/zhoujiayi/Desktop/m6A/figure-code-2-1/1A')
require(graphics)
require(grDevices)
library(gplots)
library(pheatmap)
a<-read.table("./total.txt",header=F,stringsAsFactors = F,row.names=1)
annotation_row = data.frame(
GeneClass = factor(rep(c("C1", "C2", "C3","C4","C5","C6"), c(7677,3363,6853,6313,7334,3672)))
)
rownames(annotation_row) = rownames(a)
pheatmap(a,scale="row",cluster_rows = F,cluster_cols =F,show_colnames=T,show_rownames=F,legend=T,border_color="grey",color=colorpanel(100,"#008CC1","#FAF7F6","#CF0C31"),fontsize = 20,annotation_row = annotation_row);
pheatmap(a,scale="row",cluster_rows = F,cluster_cols =F,show_colnames=T,show_rownames=F,legend=T,border_color="grey",color=colorpanel(100,"#008CC1","white","#CF0C31"),fontsize = 20,annotation_row = annotation_row);
pheatmap(a,scale="row",cluster_rows = F,cluster_cols =F,show_colnames=T,show_rownames=F,legend=T,border_color="grey",color=colorpanel(100,"#008CC1","white","#CF0C31"),fontsize = 20,annotation_row = annotation_row);
